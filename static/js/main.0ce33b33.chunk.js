(this.webpackJsonpgeowhen=this.webpackJsonpgeowhen||[]).push([[0],{102:function(e,t,r){"use strict";r.r(t);var i={};r.r(i),r.d(i,"onInitializeOvermind",(function(){return D})),r.d(i,"doFilter",(function(){return A})),r.d(i,"mergeFilter",(function(){return F})),r.d(i,"mergeStagingFilter",(function(){return B})),r.d(i,"applyFilters",(function(){return M})),r.d(i,"resetFilters",(function(){return R})),r.d(i,"toggleFilterModal",(function(){return k})),r.d(i,"selectItem",(function(){return I}));var o=r(0),n=r.n(o),a=r(20),s=r.n(a),l=r(31),c=(r(73),r(74),r(25)),d=r(108),p=r(57),g=r(106),b=r(107),j=r(63),x=r(105),u=r(62),h=r(21),m=r(2),f=r(28),y=r.n(f),v=r(56),O=r(43),C=r.n(O),w=r(33),S=r.n(w),D=function(){var e=Object(v.a)(y.a.mark((function e(t){var r,i,o,n,a,s,l,c,d,p;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.state).isLoading=!0,e.next=4,C.a.get("https://api.github.com/repos/earthhistoryviz/geowhen/contents/data/MasterData.xlsx",{headers:{Accept:"application/vnd.github.v3.raw"},responseType:"arraybuffer"});case 4:return i=e.sent,o=S.a.read(new Uint8Array(i.data),{type:"array"}),console.log("spreadsheet = ",o),n=S.a.utils.sheet_to_json(o.Sheets["Geological stages"]).slice(1),a=n.reduce((function(e,t){return e[t.Period]||(e[t.Period]=[]),e[t.Period].push(t),e}),{}),s=n.reduce((function(e,t){return e.periods.add(t.Period),t.Region&&" "!==t.Region&&e.regions.add(t.Region),e}),{periods:new Set,regions:new Set}),console.log("byperiod = ",a),r.masterdata.byperiod=a,r.masterdata.displayedStages=a,r.view.filterOptions.periods=Array.from(s.periods),r.view.filterOptions.regions=Array.from(s.regions),e.next=17,C.a.get("https://api.github.com/repos/earthhistoryviz/geowhen/contents/data/default_timescale.xlsx",{headers:{Accept:"application/vnd.github.v3.raw"},responseType:"arraybuffer"});case 17:l=e.sent,c=S.a.read(new Uint8Array(l.data),{type:"array"}),d=S.a.utils.sheet_to_json(c.Sheets.MasterChronostrat).slice(1),console.log(d),p=d.map((function(e){var t=e["Color (internat)"].split("/");return{topAge:e.Ma,color:"rgb("+t.join(", ")+")"}})),console.log(p),r.view.stageColors=p,r.isLoading=!1;case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(e){var t=e.state,r={},i=t.filter;Object.keys(t.masterdata.byperiod).forEach((function(e){var o=t.masterdata.byperiod[e];r[e]=o.filter((function(e){return e.STAGE.toUpperCase().includes(i.queryStr.toUpperCase())?(console.log("region type is: ",typeof e.Region),!i.region||"string"===typeof e.Region&&e.Region.toUpperCase().includes(i.region.toUpperCase())?!(i.period&&("string"!==typeof e.Period||!e.Period.toUpperCase().includes(i.period.toUpperCase())))&&!(i.topAge&&i.bottomAge&&(e.Base<parseFloat(i.topAge)||e.TOP>parseFloat(i.bottomAge))):(console.log("filter region denies inclusion of "+e.STAGE),!1)):(console.log("query string denies inclusion of "+e.STAGE),!1)})),"alphabet"===i.sortBy?r[e].sort((function(e,t){return e.STAGE<t.STAGE?-1:e.STAGE>t.STAGE?1:0})):"age"===i.sortBy?r[e].sort((function(e,t){return e.Base<t.Base?-1:e.Base>t.Base?1:0})):i.sortBy})),t.masterdata.displayedStages=r},F=function(e,t){var r=e.state,i=e.actions;r.filter=Object(m.a)(Object(m.a)({},r.filter),t),i.doFilter(),console.log(r.filter)},B=function(e,t){var r=e.state;r.view.filterModal.stagingFilter=Object(m.a)(Object(m.a)({},r.view.filterModal.stagingFilter),t)},M=function(e){var t=e.state,r=e.actions,i=t.view.filterModal.stagingFilter;t.view.filterModal.visible=!t.view.filterModal.visible,i.bottomAge&&!i.topAge&&(i.topAge=i.bottomAge),t.filter=Object(m.a)({},i),r.doFilter()},R=function(e){e.state.view.filterModal.stagingFilter={period:!1,region:!1,topAge:!1,bottomAge:!1,sortBy:!1,queryStr:""}},k=function(e){var t=e.state;t.view.filterModal.visible||(t.view.filterModal.stagingFilter=Object(m.a)({},t.filter)),t.view.filterModal.visible=!t.view.filterModal.visible},I=function(e,t){e.state.selectedItem=Object(m.a)({},t)},T=Object(h.d)({state:{isLoading:!0,selectedItem:!1,masterdata:{byperiod:{},displayedStages:{},raw:[]},filter:{period:!1,region:!1,topAge:!1,bottomAge:!1,sortBy:!1,queryStr:""},view:{filterModal:{visible:!1,stagingFilter:{}},filterOptions:{periods:[],regions:[]},stageColors:{}}},actions:i}),G=Object(l.c)(),N=Object(l.b)(),E=r(1),P=function(e){var t=N(),r=G(),i=r.view.filterModal,o=r.view.filterOptions,n=i.stagingFilter,a=function(){return t.toggleFilterModal()};return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(d.a,{className:"my-3",size:"lg",children:[Object(E.jsx)(p.a,{onChange:e.onChange,"aria-label":"Large","aria-describedby":"inputGroup-sizing-sm",placeholder:"Search"}),Object(E.jsx)(c.a,{variant:"primary",onClick:function(){return t.toggleFilterModal()},children:"Filter menu"}),Object(E.jsxs)(g.a,{size:"lg",show:i.visible,onHide:a,children:[Object(E.jsx)(g.a.Header,{closeButton:!0,children:Object(E.jsx)(g.a.Title,{children:"Advance Filtering Menu"})}),Object(E.jsx)(g.a.Body,{className:"p-sm-5",children:Object(E.jsxs)(b.a,{children:[Object(E.jsx)("h5",{children:"Search by:"}),Object(E.jsx)(j.a,{className:"my-2",controlId:"floatingSelect",label:"By Period",children:Object(E.jsxs)(b.a.Select,{onChange:function(e){return t.mergeStagingFilter({period:e.target.value})},"aria-label":"Floating label select example",children:[Object(E.jsx)("option",{value:"",selected:!n.period,children:"All"}),o.periods.map((function(e,t){return Object(E.jsx)("option",{value:e,selected:e===n.period,children:e},t)}))]})}),Object(E.jsx)(j.a,{className:"my-2",controlId:"floatingSelect",label:"By Region",children:Object(E.jsxs)(b.a.Select,{onChange:function(e){return t.mergeStagingFilter({region:e.target.value})},"aria-label":"Floating label select example",children:[Object(E.jsx)("option",{value:"",selected:!n.region,children:"All"}),o.regions.map((function(e,t){return Object(E.jsx)("option",{value:e,selected:e===n.region,children:e},t)}))]})}),Object(E.jsxs)(b.a.Group,{as:x.a,className:"mb-3",children:[Object(E.jsx)(b.a.Label,{column:!0,sm:"2",children:"By Age:"}),Object(E.jsx)(u.a,{sm:"4",children:Object(E.jsx)(b.a.Control,{type:"number",placeholder:"Lower Bound",onChange:function(e){t.mergeStagingFilter({bottomAge:e.target.value})},value:n.bottomAge})}),Object(E.jsx)(u.a,{className:"d-flex justify-content-center",sm:"2",children:Object(E.jsx)("p",{className:"m-auto",children:"to"})}),Object(E.jsx)(u.a,{sm:"4",children:Object(E.jsx)(b.a.Control,{type:"number",placeholder:"Upper Bound",onChange:function(e){t.mergeStagingFilter({topAge:e.target.value})},value:n.topAge})})]}),Object(E.jsx)("hr",{}),Object(E.jsx)("h5",{children:"Sort by:"}),Object(E.jsxs)(b.a.Group,{className:"mb-3",onChange:function(e){t.mergeStagingFilter({sortBy:e.target.value})},children:[Object(E.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-alphabetically",value:"alphabet",checked:"alphabet"===n.sortBy}),Object(E.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-by-age",value:"age",checked:"age"===n.sortBy}),Object(E.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-by-region (coming soon)",value:"region",checked:"region"===n.sortBy})]}),Object(E.jsx)("hr",{}),Object(E.jsx)("h5",{children:"Group by:"})]})}),Object(E.jsxs)(g.a.Footer,{children:[Object(E.jsx)(c.a,{variant:"secondary",onClick:a,children:"Close"}),Object(E.jsx)(c.a,{variant:"danger",onClick:t.resetFilters,children:"Reset"}),Object(E.jsx)(c.a,{variant:"primary",onClick:function(){return t.applyFilters()},children:"Apply"})]})]})]}),Object(E.jsx)("p",{})]})};window.processGithubResponse||(window.processGithubResponse=function(e){console.log("Callback was called w/ data: ",e)});var U=function(){var e=G(),t=N(),r=e.view.stageColors,i=e.isLoading,o=e.masterdata,n=!1;return e.selectedItem&&(function(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!=t.status}(n="/geowhen/stage-charts/".concat(e.selectedItem.Period.toUpperCase(),"_regional.jpg"))||(n=!1)),Object(E.jsx)("div",{className:"mx-auto mt-4",style:{width:"90%"},children:i?Object(E.jsx)("p",{children:"Loading..."}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(P,{onChange:function(e){t.mergeFilter({queryStr:e.target.value})}}),Object(E.jsx)("div",{className:"mt-5 border shadow-sm",style:{height:"400px",overflowX:"scroll"},children:Object(E.jsx)("div",{className:"scrolling-wrapper row flex-row flex-nowrap mt-4 pb-4 pt-2",children:Object.keys(o.displayedStages).map((function(e,i){return o.displayedStages[e]&&o.displayedStages[e].length<1?"":Object(E.jsxs)("div",{className:"col",align:"center",style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("strong",{children:e}),o.displayedStages[e].map((function(e,i){for(var o=r[0].color,n=0;n<r.length&&e.Base>r[n].topAge;n++)o=r[n+1].color;return Object(E.jsx)("div",{className:"my-2 col-8 d-flex justify-content-center",children:Object(E.jsx)(c.a,{style:{backgroundColor:o,color:"black"},onClick:function(){t.selectItem(e)},children:e.STAGE})},i)}))]},i)}))})}),e.selectedItem?Object(E.jsxs)("div",{className:"mt-5 border shadow-sm row flex-nowrap mt-4 pb-4 pt-2",style:{border:"20px solid ",borderRadius:"10px"},children:[Object(E.jsxs)("div",{style:{width:"500px"},align:"center",children:[Object(E.jsxs)("div",{style:{width:"480px",border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontSize:"34px"},children:e.selectedItem.STAGE}),Object(E.jsxs)("div",{style:{fontWeight:"normal"},children:["(Period: ",e.selectedItem.Period,")"]})]}),Object(E.jsxs)("div",{style:{width:"480px",border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:""},children:"Region:"}),Object(E.jsx)("div",{children:e.selectedItem.Region})]}),Object(E.jsxs)("div",{style:{width:"480px",border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Top Age:"}),Object(E.jsx)("div",{children:+e.selectedItem.TOP.toFixed(3)})]}),Object(E.jsxs)("div",{style:{width:"480px",border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Base Age:"}),Object(E.jsx)("div",{children:+e.selectedItem.Base.toFixed(3)})]}),Object(E.jsxs)("div",{style:{width:"480px",border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Top Calibration:"}),Object(E.jsx)("div",{children:e.selectedItem["Top calibration"]})]}),Object(E.jsxs)("div",{style:{width:"480px",border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Base Calibration:"}),Object(E.jsx)("div",{children:e.selectedItem["Base calibration"]})]})]}),Object(E.jsx)("div",{children:n?Object(E.jsx)("img",{src:n}):""})]}):""]})})};s.a.render(Object(E.jsx)(l.a,{value:T,children:Object(E.jsx)(n.a.StrictMode,{children:Object(E.jsx)(U,{})})}),document.getElementById("root"))},53:function(e,t){},73:function(e,t,r){},97:function(e,t){},98:function(e,t){}},[[102,1,2]]]);
//# sourceMappingURL=main.0ce33b33.chunk.js.map