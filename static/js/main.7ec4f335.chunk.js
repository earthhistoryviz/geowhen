(this.webpackJsonpgeowhen=this.webpackJsonpgeowhen||[]).push([[0],{103:function(e,t,r){"use strict";r.r(t);var o={};r.r(o),r.d(o,"onInitializeOvermind",(function(){return S})),r.d(o,"doFilter",(function(){return A})),r.d(o,"mergeFilter",(function(){return F})),r.d(o,"mergeStagingFilter",(function(){return B})),r.d(o,"applyFilters",(function(){return I})),r.d(o,"resetFilters",(function(){return R})),r.d(o,"toggleFilterModal",(function(){return k})),r.d(o,"selectItem",(function(){return M}));var i=r(1),s=r.n(i),n=r(20),a=r.n(n),l=r(31),c=(r(74),r(75),r(25)),d=r(108),p=r(57),b=r(106),g=r(107),j=r(63),x=r(105),h=r(62),u=r(21),m=r(2),f=r(28),O=r.n(f),v=r(56),y=r(43),C=r.n(y),w=r(33),D=r.n(w),S=function(){var e=Object(v.a)(O.a.mark((function e(t){var r,o,i,s,n,a,l,c,d,p;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.state).isLoading=!0,e.next=4,C.a.get("https://api.github.com/repos/earthhistoryviz/geowhen/contents/data/MasterData.xlsx",{headers:{Accept:"application/vnd.github.v3.raw"},responseType:"arraybuffer"});case 4:return o=e.sent,i=D.a.read(new Uint8Array(o.data),{type:"array"}),console.log("spreadsheet = ",i),s=D.a.utils.sheet_to_json(i.Sheets["Geological stages"]).slice(1),n=s.reduce((function(e,t){return e[t.Period]||(e[t.Period]=[]),e[t.Period].push(t),e}),{}),a=s.reduce((function(e,t){return e.periods.add(t.Period),t.Region&&" "!==t.Region&&e.regions.add(t.Region),e}),{periods:new Set,regions:new Set}),console.log("byperiod = ",n),r.masterdata.byperiod=n,r.masterdata.displayedStages=n,r.view.filterOptions.periods=Array.from(a.periods),r.view.filterOptions.regions=Array.from(a.regions),e.next=17,C.a.get("https://api.github.com/repos/earthhistoryviz/geowhen/contents/data/default_timescale.xlsx",{headers:{Accept:"application/vnd.github.v3.raw"},responseType:"arraybuffer"});case 17:l=e.sent,c=D.a.read(new Uint8Array(l.data),{type:"array"}),d=D.a.utils.sheet_to_json(c.Sheets.MasterChronostrat).slice(1),console.log(d),p=d.map((function(e){var t=e["Color (internat)"].split("/");return{topAge:e.Ma,color:"rgb("+t.join(", ")+")"}})),console.log(p),r.view.stageColors=p,r.isLoading=!1;case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(e){var t=e.state,r={},o=t.filter;Object.keys(t.masterdata.byperiod).forEach((function(e){var i=t.masterdata.byperiod[e];r[e]=i.filter((function(e){return e.STAGE.toUpperCase().includes(o.queryStr.toUpperCase())?(console.log("region type is: ",typeof e.Region),!o.region||"string"===typeof e.Region&&e.Region.toUpperCase().includes(o.region.toUpperCase())?!(o.period&&("string"!==typeof e.Period||!e.Period.toUpperCase().includes(o.period.toUpperCase())))&&!(o.topAge&&o.bottomAge&&(e.Base<parseFloat(o.topAge)||e.TOP>parseFloat(o.bottomAge))):(console.log("filter region denies inclusion of "+e.STAGE),!1)):(console.log("query string denies inclusion of "+e.STAGE),!1)})),"alphabet"===o.sortBy?r[e].sort((function(e,t){return e.STAGE<t.STAGE?-1:e.STAGE>t.STAGE?1:0})):"age"===o.sortBy?r[e].sort((function(e,t){return e.Base<t.Base?-1:e.Base>t.Base?1:0})):o.sortBy})),t.masterdata.displayedStages=r},F=function(e,t){var r=e.state,o=e.actions;r.filter=Object(m.a)(Object(m.a)({},r.filter),t),o.doFilter(),console.log(r.filter)},B=function(e,t){var r=e.state;r.view.filterModal.stagingFilter=Object(m.a)(Object(m.a)({},r.view.filterModal.stagingFilter),t)},I=function(e){var t=e.state,r=e.actions,o=t.view.filterModal.stagingFilter;t.view.filterModal.visible=!t.view.filterModal.visible,o.bottomAge&&!o.topAge&&(o.topAge=o.bottomAge),t.filter=Object(m.a)({},o),r.doFilter()},R=function(e){e.state.view.filterModal.stagingFilter={period:!1,region:!1,topAge:!1,bottomAge:!1,sortBy:!1,queryStr:""}},k=function(e){var t=e.state;t.view.filterModal.visible||(t.view.filterModal.stagingFilter=Object(m.a)({},t.filter)),t.view.filterModal.visible=!t.view.filterModal.visible},M=function(e,t){var r=e.state;r.selectedItem=!1!==t&&Object(m.a)({},t)},N=Object(u.d)({state:{isLoading:!0,selectedItem:!1,masterdata:{byperiod:{},displayedStages:{},raw:[]},filter:{period:!1,region:!1,topAge:!1,bottomAge:!1,sortBy:!1,queryStr:""},view:{filterModal:{visible:!1,stagingFilter:{}},filterOptions:{periods:[],regions:[]},stageColors:{}}},actions:o}),T=Object(l.c)(),G=Object(l.b)(),E=r(0),P=function(e){var t=G(),r=T(),o=r.view.filterModal,i=r.view.filterOptions,s=o.stagingFilter,n=function(){return t.toggleFilterModal()};return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(d.a,{className:"my-3",size:"lg",children:[Object(E.jsx)(p.a,{onChange:e.onChange,"aria-label":"Large","aria-describedby":"inputGroup-sizing-sm",placeholder:"Search"}),Object(E.jsx)(c.a,{variant:"primary",onClick:function(){return t.toggleFilterModal()},children:"Filter menu"}),Object(E.jsxs)(b.a,{size:"lg",show:o.visible,onHide:n,children:[Object(E.jsx)(b.a.Header,{closeButton:!0,children:Object(E.jsx)(b.a.Title,{children:"Advance Filtering Menu"})}),Object(E.jsx)(b.a.Body,{className:"p-sm-5",children:Object(E.jsxs)(g.a,{children:[Object(E.jsx)("h5",{children:"Search by:"}),Object(E.jsx)(j.a,{className:"my-2",controlId:"floatingSelect",label:"By Period",children:Object(E.jsxs)(g.a.Select,{onChange:function(e){return t.mergeStagingFilter({period:e.target.value})},"aria-label":"Floating label select example",children:[Object(E.jsx)("option",{value:"",selected:!s.period,children:"All"}),i.periods.map((function(e,t){return Object(E.jsx)("option",{value:e,selected:e===s.period,children:e},t)}))]})}),Object(E.jsx)(j.a,{className:"my-2",controlId:"floatingSelect",label:"By Region",children:Object(E.jsxs)(g.a.Select,{onChange:function(e){return t.mergeStagingFilter({region:e.target.value})},"aria-label":"Floating label select example",children:[Object(E.jsx)("option",{value:"",selected:!s.region,children:"All"}),i.regions.map((function(e,t){return Object(E.jsx)("option",{value:e,selected:e===s.region,children:e},t)}))]})}),Object(E.jsxs)(g.a.Group,{as:x.a,className:"mb-3",children:[Object(E.jsx)(g.a.Label,{column:!0,sm:"2",children:"By Age:"}),Object(E.jsx)(h.a,{sm:"4",children:Object(E.jsx)(g.a.Control,{type:"number",placeholder:"Lower Bound",onChange:function(e){t.mergeStagingFilter({bottomAge:e.target.value})},value:s.bottomAge})}),Object(E.jsx)(h.a,{className:"d-flex justify-content-center",sm:"2",children:Object(E.jsx)("p",{className:"m-auto",children:"to"})}),Object(E.jsx)(h.a,{sm:"4",children:Object(E.jsx)(g.a.Control,{type:"number",placeholder:"Upper Bound",onChange:function(e){t.mergeStagingFilter({topAge:e.target.value})},value:s.topAge})})]}),Object(E.jsx)("hr",{}),Object(E.jsx)("h5",{children:"Sort by:"}),Object(E.jsxs)(g.a.Group,{className:"mb-3",onChange:function(e){t.mergeStagingFilter({sortBy:e.target.value})},children:[Object(E.jsx)(g.a.Check,{type:"radio",name:"sortBy",label:"sort-alphabetically",value:"alphabet",checked:"alphabet"===s.sortBy}),Object(E.jsx)(g.a.Check,{type:"radio",name:"sortBy",label:"sort-by-age",value:"age",checked:"age"===s.sortBy}),Object(E.jsx)(g.a.Check,{type:"radio",name:"sortBy",label:"sort-by-region (coming soon)",value:"region",checked:"region"===s.sortBy})]}),Object(E.jsx)("hr",{}),Object(E.jsx)("h5",{children:"Group by:"})]})}),Object(E.jsxs)(b.a.Footer,{children:[Object(E.jsx)(c.a,{variant:"secondary",onClick:n,children:"Close"}),Object(E.jsx)(c.a,{variant:"danger",onClick:t.resetFilters,children:"Reset"}),Object(E.jsx)(c.a,{variant:"primary",onClick:function(){return t.applyFilters()},children:"Apply"})]})]})]}),Object(E.jsx)("p",{})]})},L=function(){var e=T(),t=G(),r=function(){t.selectItem(!1)},o=!1;return e.selectedItem&&(function(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!==t.status}(o="/geowhen/stage-charts/".concat(e.selectedItem.Period.toUpperCase(),"_regional.jpg"))||(o=!1)),console.log(e.selectedItem),Object(E.jsxs)(b.a,{show:!1!==e.selectedItem,onHide:r,size:"xl",style:{padding:"0px"},children:[Object(E.jsx)(b.a.Header,{closeButton:!0,children:Object(E.jsxs)(b.a.Title,{children:["Stage Information - ",e.selectedItem.STAGE]})}),Object(E.jsx)(b.a.Body,{className:"p-sm-5",children:e.selectedItem?Object(E.jsxs)("div",{className:"border shadow-sm mb-4 pb-4 pt-2",style:{border:"20px solid ",borderRadius:"10px"},children:[Object(E.jsxs)("div",{className:"w-100",align:"center",children:[Object(E.jsxs)("div",{style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{children:Object(E.jsx)("h3",{children:e.selectedItem.STAGE})}),Object(E.jsxs)("div",{style:{fontWeight:"normal"},children:["(Period: ",e.selectedItem.Period,")"]})]}),e.selectedItem.Rank?Object(E.jsxs)("div",{style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Rank:"}),Object(E.jsx)("div",{children:e.selectedItem.Rank})]}):"",Object(E.jsxs)("div",{style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Region:"}),Object(E.jsx)("div",{children:e.selectedItem.Region})]}),Object(E.jsxs)("div",{style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Top Age:"}),Object(E.jsx)("div",{children:+e.selectedItem.TOP.toFixed(3)})]}),Object(E.jsxs)("div",{style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Base Age:"}),Object(E.jsx)("div",{children:+e.selectedItem.Base.toFixed(3)})]}),e.selectedItem.Comments?Object(E.jsxs)("div",{style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Comments:"}),Object(E.jsx)("div",{children:e.selectedItem.Comments})]}):"",Object(E.jsxs)("div",{style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Top Calibration:"}),Object(E.jsx)("div",{children:e.selectedItem["Top calibration"]})]}),Object(E.jsxs)("div",{style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("div",{style:{fontWeight:"bold"},children:"Base Calibration:"}),Object(E.jsx)("div",{children:e.selectedItem["Base calibration"]})]})]}),Object(E.jsx)("div",{className:"d-flex justify-content-center",style:{overflow:"scroll"},children:o?Object(E.jsx)("img",{className:"m-auto",src:o,alt:"Stage Chart"}):""})]}):""}),Object(E.jsx)(b.a.Footer,{children:Object(E.jsx)(c.a,{variant:"secondary",onClick:r,children:"Close"})})]})};window.processGithubResponse||(window.processGithubResponse=function(e){console.log("Callback was called w/ data: ",e)});var U=function(){var e=T(),t=G(),r=e.view.stageColors,o=e.isLoading,i=e.masterdata;return e.selectedItem&&(function(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!==t.status}("/geowhen/stage-charts/".concat(e.selectedItem.Period.toUpperCase(),"_regional.jpg"))||!1),Object(E.jsxs)("div",{className:"mx-auto mt-4",style:{width:"90%"},children:[Object(E.jsxs)("div",{className:"mx-auto mt-4",children:[Object(E.jsx)("div",{children:Object(E.jsx)("img",{src:"/geowhen/geowhen_logo.png",height:"75px",alt:"GeoWhen Logo"})}),Object(E.jsxs)("div",{children:["Lookup table for regional stages provided by",Object(E.jsx)("br",{}),Object(E.jsx)("a",{href:"https://ccgm.org/en/",children:"Commission for the Geological Map of the World (UNESCO)"})]})]}),o?Object(E.jsx)("p",{children:"Loading..."}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(P,{onChange:function(e){t.mergeFilter({queryStr:e.target.value})}}),Object(E.jsxs)("div",{children:[Object(E.jsx)("b",{children:"Click"})," on a stage below for details, ",Object(E.jsx)("b",{children:"Search"})," by portion of name, or ",Object(E.jsx)("b",{children:"Filter"})," by region or geologic or numerical age.",Object(E.jsx)("br",{}),"Scroll down for more stages, scroll right for more periods."]}),Object(E.jsx)("div",{className:"mt-5 border shadow-sm",style:{height:"400px",overflowX:"scroll",marginTop:"5px !important"},children:Object(E.jsx)("div",{className:"scrolling-wrapper row flex-row flex-nowrap mt-4 pb-4 pt-2",children:Object.keys(i.displayedStages).map((function(e,o){return i.displayedStages[e]&&i.displayedStages[e].length<1?"":Object(E.jsxs)("div",{className:"col",align:"center",style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(E.jsx)("strong",{children:e}),i.displayedStages[e].map((function(e,o){for(var i=r[0].color,s=0;s<r.length&&e.Base>r[s].topAge;s++)i=r[s+1].color;return Object(E.jsx)("div",{className:"my-2 col-8 d-flex justify-content-center",children:Object(E.jsx)(c.a,{style:{backgroundColor:i,color:"black"},onClick:function(){t.selectItem(e)},children:e.STAGE})},o)}))]},o)}))})}),Object(E.jsx)(L,{})]})]})};console.log=function(){},a.a.render(Object(E.jsx)(l.a,{value:N,children:Object(E.jsx)(s.a.StrictMode,{children:Object(E.jsx)(U,{})})}),document.getElementById("root"))},53:function(e,t){},74:function(e,t,r){},98:function(e,t){},99:function(e,t){}},[[103,1,2]]]);
//# sourceMappingURL=main.7ec4f335.chunk.js.map