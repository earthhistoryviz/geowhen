{"version":3,"sources":["overmind/actions.js","overmind/index.js","overmind/state.js","components/Search.js","App.js","index.js"],"names":["onInitializeOvermind","a","state","isLoading","axios","get","headers","Accept","responseType","result","spreadsheet","xlsx","read","Uint8Array","data","type","console","log","masterdata","utils","sheet_to_json","Sheets","slice","byperiod","reduce","acc","row","Period","push","options","periods","add","Region","regions","Set","displayedStages","view","filterOptions","Array","from","colorsResult","colorsSpreadsheet","colorsMasterdata","MasterChronostrat","colorLookup","map","rgb","split","topAge","Ma","color","join","stageColors","doFilter","filteredPeriods","filter","Object","keys","forEach","periodName","bp","stageData","STAGE","toUpperCase","includes","queryStr","region","period","bottomAge","Base","parseFloat","TOP","sortBy","sort","b","mergeFilter","toMerge","actions","mergeStagingFilter","filterModal","stagingFilter","applyFilters","sf","visible","resetFilters","toggleFilterModal","selectItem","selected","selectedItem","overmind","createOvermind","raw","useAppState","createStateHook","useActions","createActionsHook","Search","props","fm","filterState","handleCloseModal","InputGroup","className","size","FormControl","onChange","placeholder","Button","variant","onClick","Modal","show","onHide","Header","closeButton","Title","Body","Form","FloatingLabel","controlId","label","Select","event","target","value","index","Group","as","Row","Label","column","sm","Col","Control","Check","name","checked","Footer","window","processGithubResponse","App","stageimage","image_url","http","XMLHttpRequest","open","send","status","imageExists","style","width","src","height","href","evt","overflowX","marginTop","length","align","border","borderRadius","boxShadow","margin","stage","currColor","i","backgroundColor","fontSize","fontWeight","toFixed","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.73d62810.chunk.js","sourcesContent":["import axios from 'axios';\nimport xlsx from 'xlsx';\n// import clone from 'clone';\n\nexport const onInitializeOvermind = async ({ state }) => {\n  state.isLoading = true;\n  const result = await axios.get('https://api.github.com/repos/earthhistoryviz/geowhen/contents/data/MasterData.xlsx', {\n    headers: {\n      Accept: 'application/vnd.github.v3.raw'\n    },\n    responseType: 'arraybuffer'\n  });\n  const spreadsheet = xlsx.read(new Uint8Array(result.data), { type: 'array' });\n  console.log('spreadsheet = ', spreadsheet);\n  const masterdata = xlsx.utils.sheet_to_json(spreadsheet.Sheets['Geological stages']).slice(1);\n  // console.log(masterdata);\n\n  // Note from Aaron: we stopped here, we were debugging any period names that show up in\n  // the byperiod variable which didn't make sense (\"undefined\", \"era\", etc.).  All of them\n  // found thus far we errors in the spreadsheet itself, so no need for code to deal with them.\n  const byperiod = masterdata.reduce((acc, row) => {\n    if (!acc[row.Period]) acc[row.Period] = [];\n    acc[row.Period].push(row);\n    return acc;\n  }, {});\n\n  // Populate options for periods and regions in the filtering menu\n  const options = masterdata.reduce((acc, row) => {\n    acc.periods.add(row.Period);\n    if (row.Region && row.Region !== ' ') acc.regions.add(row.Region);\n\n    return acc;\n  }, { periods: new Set(), regions: new Set() });\n\n  console.log('byperiod = ', byperiod);\n  state.masterdata.byperiod = byperiod;\n  state.masterdata.displayedStages = byperiod;\n\n  state.view.filterOptions.periods = Array.from(options.periods);\n  state.view.filterOptions.regions = Array.from(options.regions);\n\n  // Populate colors\n  const colorsResult = await axios.get('https://api.github.com/repos/earthhistoryviz/geowhen/contents/data/default_timescale.xlsx', {\n    headers: {\n      Accept: 'application/vnd.github.v3.raw'\n    },\n    responseType: 'arraybuffer'\n  });\n  const colorsSpreadsheet = xlsx.read(new Uint8Array(colorsResult.data), { type: 'array' });\n  const colorsMasterdata = xlsx.utils.sheet_to_json(colorsSpreadsheet.Sheets.MasterChronostrat).slice(1);\n  console.log(colorsMasterdata);\n\n  // const colorLookup = colorsMasterdata.reduce((acc, row) => {\n  //   const rgb = row['Color (internat)'].split('/');\n  //   acc[row.Ma] = 'rgb(' + rgb.join(', ') + ')';\n  //   return acc;\n  // }, {});\n\n  const colorLookup = colorsMasterdata.map((row) => {\n    const rgb = row['Color (internat)'].split('/');\n    return { topAge: row.Ma, color: 'rgb(' + rgb.join(', ') + ')' };\n  });\n\n  console.log(colorLookup);\n\n  state.view.stageColors = colorLookup;\n\n  state.isLoading = false;\n};\n\n/****************************************************************************\n *\n * Filtering\n *\n ***************************************************************************/\n\nexport const doFilter = ({ state }) => {\n  const filteredPeriods = {};\n  const filter = state.filter;\n  Object.keys(state.masterdata.byperiod).forEach((periodName) => {\n    const bp = state.masterdata.byperiod[periodName];\n    filteredPeriods[periodName] = bp.filter(stageData => {\n      if (!stageData.STAGE.toUpperCase().includes(filter.queryStr.toUpperCase())) {\n        console.log('query string denies inclusion of ' + stageData.STAGE);\n        return false;\n      }\n      console.log('region type is: ', typeof stageData.Region);\n      if (filter.region && ((typeof stageData.Region !== 'string') || !stageData.Region.toUpperCase().includes(filter.region.toUpperCase()))) {\n        console.log('filter region denies inclusion of ' + stageData.STAGE);\n        return false;\n      }\n\n      if (filter.period && ((typeof stageData.Period !== 'string') || !stageData.Period.toUpperCase().includes(filter.period.toUpperCase()))) {\n        return false;\n      }\n\n      if (filter.topAge && filter.bottomAge && (stageData.Base < parseFloat(filter.topAge) || stageData.TOP > parseFloat(filter.bottomAge))) {\n        return false;\n      }\n      return true;\n    });\n\n    if (filter.sortBy === 'alphabet') {\n      filteredPeriods[periodName].sort((a, b) => {\n        if (a.STAGE < b.STAGE) return -1;\n        else if (a.STAGE > b.STAGE) return 1;\n        else return 0;\n      });\n    } else if (filter.sortBy === 'age') {\n      filteredPeriods[periodName].sort((a, b) => {\n        if (a.Base < b.Base) return -1;\n        else if (a.Base > b.Base) return 1;\n        else return 0;\n      });\n    } else if (filter.sortBy === 'region') {\n      // might need to change UI for this\n    }\n  });\n\n  state.masterdata.displayedStages = filteredPeriods;\n};\n\nexport const mergeFilter = ({ state, actions }, toMerge) => {\n  state.filter = {\n    ...state.filter,\n    ...toMerge\n  };\n\n  actions.doFilter();\n  console.log(state.filter);\n};\n\nexport const mergeStagingFilter = ({ state }, toMerge) => {\n  state.view.filterModal.stagingFilter = {\n    ...state.view.filterModal.stagingFilter,\n    ...toMerge\n  };\n};\n\nexport const applyFilters = ({ state, actions }) => {\n  const sf = state.view.filterModal.stagingFilter;\n  state.view.filterModal.visible = !state.view.filterModal.visible;\n  if (sf.bottomAge && !sf.topAge) {\n    sf.topAge = sf.bottomAge;\n  }\n  state.filter = { ...sf };\n  actions.doFilter();\n};\n\nexport const resetFilters = ({ state }) => {\n  state.view.filterModal.stagingFilter = {\n    period: false,\n    region: false,\n    topAge: false,\n    bottomAge: false,\n    sortBy: false,\n    queryStr: ''\n  };\n};\n\nexport const toggleFilterModal = ({ state }) => {\n  if (!state.view.filterModal.visible) {\n    state.view.filterModal.stagingFilter = { ...state.filter };\n  }\n  state.view.filterModal.visible = !state.view.filterModal.visible;\n};\n\nexport const selectItem = ({ state }, selected) => {\n  state.selectedItem = { ...selected };\n};\n","import { createOvermind } from 'overmind';\nimport { createStateHook, createActionsHook } from 'overmind-react';\n\nimport { state } from './state';\nimport * as actions from './actions';\n\nexport const overmind = createOvermind({\n  state,\n  actions,\n});\n\nexport const useAppState = createStateHook();\nexport const useActions = createActionsHook();\n\n","export const state = {\n  isLoading: true,\n  selectedItem: false,\n  masterdata: {\n    byperiod: {},\n    displayedStages: {}, // same format as byperiod\n    raw: []\n  },\n  filter: {\n    period: false,\n    region: false,\n    topAge: false,\n    bottomAge: false,\n    sortBy: false,\n    queryStr: ''\n  },\n  view: {\n    filterModal: {\n      visible: false,\n      stagingFilter: {} // same as filter above\n    },\n    filterOptions: {\n      periods: [],\n      regions: []\n    },\n    stageColors: {}\n  }\n};\n","import Button from 'react-bootstrap/Button';\nimport React from 'react';\nimport { InputGroup, FormControl, Modal, FloatingLabel, Form, Row, Col } from 'react-bootstrap';\nimport { useAppState, useActions } from '../overmind';\n\nconst Search = (props) => {\n  const actions = useActions();\n  const state = useAppState();\n\n  const fm = state.view.filterModal;\n  const filterOptions = state.view.filterOptions;\n  const filterState = fm.stagingFilter;\n\n  const handleCloseModal = () => actions.toggleFilterModal();\n  const handleShowModal = () => actions.toggleFilterModal();\n  const handleSubmit = () => actions.applyFilters();\n\n  return (\n    <>\n      <InputGroup className='my-3' size='lg'>\n        <FormControl onChange={props.onChange} aria-label='Large' aria-describedby='inputGroup-sizing-sm' placeholder='Search' />\n        <Button variant='primary' onClick={handleShowModal}>\n          Filter menu\n        </Button>\n\n        <Modal size='lg' show={fm.visible} onHide={handleCloseModal}>\n          <Modal.Header closeButton>\n            <Modal.Title>Advance Filtering Menu</Modal.Title>\n          </Modal.Header>\n\n          <Modal.Body className='p-sm-5'>\n            <Form>\n              <h5>Search by:</h5>\n              <FloatingLabel className='my-2' controlId='floatingSelect' label='By Period'>\n                <Form.Select onChange={event => actions.mergeStagingFilter({ period: event.target.value })} aria-label='Floating label select example'>\n                  <option value='' selected={!filterState.period}>All</option>\n                  {filterOptions.periods.map((period, index) => (\n                    <option key={index} value={period} selected={period === filterState.period}>{period}</option>\n                  ))}\n                </Form.Select>\n              </FloatingLabel>\n\n              <FloatingLabel className='my-2' controlId='floatingSelect' label='By Region'>\n                <Form.Select onChange={event => actions.mergeStagingFilter({ region: event.target.value })} aria-label='Floating label select example'>\n                  <option value='' selected={!filterState.region}>All</option>\n                  {filterOptions.regions.map((region, index) => (\n                    <option key={index} value={region} selected={region === filterState.region}>{region}</option>\n                  ))}\n                </Form.Select>\n              </FloatingLabel>\n\n              <Form.Group as={Row} className='mb-3'>\n                <Form.Label column sm='2'>\n                  By Age:\n                </Form.Label>\n                <Col sm='4'>\n                  <Form.Control\n                    type='number'\n                    placeholder='Lower Bound'\n                    onChange={event => { actions.mergeStagingFilter({ bottomAge: event.target.value }); }}\n                    value={filterState.bottomAge}\n                  />\n                </Col>\n                <Col className='d-flex justify-content-center' sm='2'>\n                  <p className='m-auto'>to</p>\n                </Col>\n                <Col sm='4'>\n                  <Form.Control\n                    type='number'\n                    placeholder='Upper Bound'\n                    onChange={event => { actions.mergeStagingFilter({ topAge: event.target.value }); }}\n                    value={filterState.topAge}\n                  />\n                </Col>\n              </Form.Group>\n\n              <hr />\n              <h5>Sort by:</h5>\n\n              <Form.Group\n                className='mb-3'\n                onChange={event => { actions.mergeStagingFilter({ sortBy: event.target.value }); }}\n              >\n                <Form.Check\n                  type='radio'\n                  name='sortBy'\n                  label='sort-alphabetically'\n                  value='alphabet'\n                  checked={filterState.sortBy === 'alphabet'}\n                />\n                <Form.Check\n                  type='radio'\n                  name='sortBy'\n                  label='sort-by-age'\n                  value='age'\n                  checked={filterState.sortBy === 'age'}\n                />\n                <Form.Check\n                  type='radio'\n                  name='sortBy'\n                  label='sort-by-region (coming soon)'\n                  value='region'\n                  checked={filterState.sortBy === 'region'}\n                />\n              </Form.Group>\n              <hr />\n              <h5>Group by:</h5>\n            </Form>\n          </Modal.Body>\n\n          <Modal.Footer>\n            <Button variant='secondary' onClick={handleCloseModal}>\n              Close\n            </Button>\n            <Button variant='danger' onClick={actions.resetFilters}>\n              Reset\n            </Button>\n            <Button variant='primary' onClick={handleSubmit}>\n              Apply\n            </Button>\n          </Modal.Footer>\n        </Modal>\n      </InputGroup>\n      <p />\n    </>\n  );\n};\n\nexport default Search;\n","import 'bootstrap/dist/css/bootstrap.min.css';\n\nimport Button from 'react-bootstrap/Button';\nimport Search from './components/Search';\nimport { useAppState, useActions } from './overmind';\n\nif (!window.processGithubResponse) {\n  window.processGithubResponse = (data) => {\n    console.log('Callback was called w/ data: ', data);\n  };\n}\n\nfunction imageExists (image_url) {\n  const http = new XMLHttpRequest();\n  http.open('HEAD', image_url, false);\n  http.send();\n  return http.status != 404;\n}\n\nfunction App () {\n  const state = useAppState();\n  const actions = useActions();\n\n  const stageColors = state.view.stageColors;\n\n  // const result = masterdata.displayedStages(\"Quaternary\");\n  const { isLoading, masterdata } = state;\n\n  const searchUpdated = (evt) => {\n    actions.mergeFilter({ queryStr: evt.target.value });\n  };\n\n  let stageimage = false;\n  if (state.selectedItem) {\n    stageimage = `/geowhen/stage-charts/${state.selectedItem.Period.toUpperCase()}_regional.jpg`;\n    if (!imageExists(stageimage)) {\n      stageimage = false;\n    }\n  }\n\n  return (\n    <div className='mx-auto mt-4' style={{ width: '90%' }}>\n      <div className='mx-auto mt-4'>{/*style={{width: '100%', minHeight: '30px', display: 'flex', flexDirection: 'row' }}> */}\n        <div>\n          <img src='/geowhen/geowhen_logo.png' height='75px' />\n        </div>\n        <div>\n          Lookup table for regional stages provided by<br/> \n          <a href=\"https://ccgm.org/en/\">Commission for the Geological Map of the World (UNESCO)</a>\n        </div>\n      </div>\n      {/* Will show \"loading...\" when the stages data is not loaded */}\n      {!isLoading\n        ? (\n          <>\n            <Search onChange={searchUpdated} />\n            <div>\n              <b>Click</b> on a stage below for details, <b>Search</b> by portion of name, or <b>Filter</b> by region or geologic or numerical age.<br/>\n              Scroll down for more stages, scroll right for more periods.\n            </div>\n            <div\n              className='mt-5 border shadow-sm'\n              style={{ height: '400px', overflowX: 'scroll', marginTop: '5px !important' }}\n            >\n              <div className='scrolling-wrapper row flex-row flex-nowrap mt-4 pb-4 pt-2'>\n\n                {Object.keys(masterdata.displayedStages).map((periodName, index) => {\n                  if (masterdata.displayedStages[periodName] && masterdata.displayedStages[periodName].length < 1) {\n                    return '';\n                  }\n\n                  return (\n                    <div className='col' align='center' style={{ border: '1px solid #DDDDDD', borderRadius: '3px', boxShadow: '3px 3px #CCCCC', margin: '5px 5px 5px 5px' }} key={index}>\n                      <strong>{periodName}</strong>\n                      {masterdata.displayedStages[periodName].map((stage, index) => {\n                        let currColor = stageColors[0].color;\n\n                        for (let i = 0; i < stageColors.length; i++) {\n                          if (stage.Base > stageColors[i].topAge) {\n                            currColor = stageColors[i+1].color;\n                          } else {\n                            break;\n                          }\n                        }\n\n                        return (\n                          <div key={index} className='my-2 col-8 d-flex justify-content-center'>\n\n                            <Button style={{ backgroundColor: currColor, color: 'black' }} onClick={() => { actions.selectItem(stage); }}>\n                              {stage.STAGE}\n                            </Button>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  );\n                })}\n\n              </div>\n\n            </div>\n\n            {/* Main content */}\n            {!state.selectedItem ? ''\n              : <div className='mt-5 border shadow-sm row flex-nowrap mt-4 pb-4 pt-2' style={{ border: '20px solid ', borderRadius: '10px' }}>\n                <div style={{ width: '500px' }} align='center'>\n                  <div style={{ width: '480px', border: '1px solid #DDDDDD', borderRadius: '3px', boxShadow: '3px 3px #CCCCC', margin: '5px 5px 5px 5px' }}>\n                    <div style={{ fontSize: '34px' }}>\n                      {state.selectedItem.STAGE}\n                    </div>\n                    <div style={{ fontWeight: 'normal' }}>\n                      (Period: {state.selectedItem.Period})\n                    </div>\n                  </div>\n                  <div style={{ width: '480px', border: '1px solid #DDDDDD', borderRadius: '3px', boxShadow: '3px 3px #CCCCC', margin: '5px 5px 5px 5px' }}>\n                    <div style={{ fontWeight: '' }}>\n                      Region:\n                    </div>\n                    <div>\n                      {state.selectedItem.Region}\n                    </div>\n                  </div>\n                  <div style={{ width: '480px', border: '1px solid #DDDDDD', borderRadius: '3px', boxShadow: '3px 3px #CCCCC', margin: '5px 5px 5px 5px' }}>\n                    <div style={{ fontWeight: 'bold' }}>\n                      Top Age:\n                    </div>\n                    <div>\n                      {+(state.selectedItem.TOP).toFixed(3)}\n                    </div>\n                  </div>\n                  <div style={{ width: '480px', border: '1px solid #DDDDDD', borderRadius: '3px', boxShadow: '3px 3px #CCCCC', margin: '5px 5px 5px 5px' }}>\n                    <div style={{ fontWeight: 'bold' }}>\n                      Base Age:\n                    </div>\n                    <div>\n                      {+(state.selectedItem.Base).toFixed(3)}\n                    </div>\n                  </div>\n                  <div style={{ width: '480px', border: '1px solid #DDDDDD', borderRadius: '3px', boxShadow: '3px 3px #CCCCC', margin: '5px 5px 5px 5px' }}>\n                    <div style={{ fontWeight: 'bold' }}>\n                      Top Calibration:\n                    </div>\n                    <div>\n                      {state.selectedItem['Top calibration']}\n                    </div>\n                  </div>\n                  <div style={{ width: '480px', border: '1px solid #DDDDDD', borderRadius: '3px', boxShadow: '3px 3px #CCCCC', margin: '5px 5px 5px 5px' }}>\n                    <div style={{ fontWeight: 'bold' }}>\n                      Base Calibration:\n                    </div>\n                    <div>\n                      {state.selectedItem['Base calibration']}\n                    </div>\n                  </div>\n\n                </div>\n                <div>\n                  {stageimage ? <img src={stageimage} /> : ''}\n                </div>\n                </div>}\n\n          </>\n          )\n        : <p>Loading...</p>}\n\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'overmind-react';\nimport './index.css';\nimport App from './App';\n\nimport { overmind } from './overmind';\n\nReactDOM.render(\n  <Provider value={overmind}>\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}