(this.webpackJsonpgeowhen=this.webpackJsonpgeowhen||[]).push([[0],{102:function(e,t,r){"use strict";r.r(t);var i={};r.r(i),r.d(i,"onInitializeOvermind",(function(){return F})),r.d(i,"doFilter",(function(){return C})),r.d(i,"mergeFilter",(function(){return B})),r.d(i,"mergeStagingFilter",(function(){return M})),r.d(i,"applyFilters",(function(){return I})),r.d(i,"resetFilters",(function(){return k})),r.d(i,"toggleFilterModal",(function(){return G})),r.d(i,"selectItem",(function(){return T}));var n=r(0),a=r.n(n),o=r(20),s=r.n(o),l=r(31),c=(r(73),r(74),r(25)),d=r(108),g=r(57),p=r(106),b=r(107),j=r(63),u=r(105),h=r(62),m=r(21),f=r(2),x=r(28),O=r.n(x),y=r(55),v=r(56),w=r.n(v),S=r(42),A=r.n(S),F=function(){var e=Object(y.a)(O.a.mark((function e(t){var r,i,n,a,o,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.state).isLoading=!0,e.next=4,w.a.get("https://api.github.com/repos/earthhistoryviz/geowhen/contents/data/MasterData.xlsx",{headers:{Accept:"application/vnd.github.v3.raw"},responseType:"arraybuffer"});case 4:i=e.sent,n=A.a.read(new Uint8Array(i.data),{type:"array"}),console.log("spreadsheet = ",n),a=A.a.utils.sheet_to_json(n.Sheets["Geological stages"]).slice(1),o=a.reduce((function(e,t){return e[t.Period]||(e[t.Period]=[]),e[t.Period].push(t),e}),{}),s=a.reduce((function(e,t){return e.periods.add(t.Period),t.Region&&" "!==t.Region&&e.regions.add(t.Region),e}),{periods:new Set,regions:new Set}),console.log("byperiod = ",o),r.masterdata.byperiod=o,r.masterdata.displayedStages=o,r.view.filterOptions.periods=Array.from(s.periods),r.view.filterOptions.regions=Array.from(s.regions),r.isLoading=!1;case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e){var t=e.state,r={},i=t.filter;Object.keys(t.masterdata.byperiod).forEach((function(e){var n=t.masterdata.byperiod[e];r[e]=n.filter((function(e){return e.STAGE.toUpperCase().includes(i.queryStr.toUpperCase())?(console.log("region type is: ",typeof e.Region),!i.region||"string"===typeof e.Region&&e.Region.toUpperCase().includes(i.region.toUpperCase())?!(i.period&&("string"!==typeof e.Period||!e.Period.toUpperCase().includes(i.period.toUpperCase())))&&!(i.topAge&&i.bottomAge&&(e.Base<parseFloat(i.topAge)||e.TOP>parseFloat(i.bottomAge))):(console.log("filter region denies inclusion of "+e.STAGE),!1)):(console.log("query string denies inclusion of "+e.STAGE),!1)})),"alphabet"===i.sortBy?r[e].sort((function(e,t){return e.STAGE<t.STAGE?-1:e.STAGE>t.STAGE?1:0})):"age"===i.sortBy?r[e].sort((function(e,t){return e.Base<t.Base?-1:e.Base>t.Base?1:0})):i.sortBy})),t.masterdata.displayedStages=r},B=function(e,t){var r=e.state,i=e.actions;r.filter=Object(f.a)(Object(f.a)({},r.filter),t),i.doFilter(),console.log(r.filter)},M=function(e,t){var r=e.state;r.view.filterModal.stagingFilter=Object(f.a)(Object(f.a)({},r.view.filterModal.stagingFilter),t)},I=function(e){var t=e.state,r=e.actions,i=t.view.filterModal.stagingFilter;t.view.filterModal.visible=!t.view.filterModal.visible,i.bottomAge&&!i.topAge&&(i.topAge=i.bottomAge),t.filter=Object(f.a)({},i),r.doFilter()},k=function(e){e.state.view.filterModal.stagingFilter={period:!1,region:!1,topAge:!1,bottomAge:!1,sortBy:!1,queryStr:""}},G=function(e){var t=e.state;t.view.filterModal.visible||(t.view.filterModal.stagingFilter=Object(f.a)({},t.filter)),t.view.filterModal.visible=!t.view.filterModal.visible},T=function(e,t){e.state.selectedItem=Object(f.a)({},t)},N=Object(m.d)({state:{isLoading:!0,selectedItem:!1,masterdata:{byperiod:{},displayedStages:{},raw:[]},filter:{period:!1,region:!1,topAge:!1,bottomAge:!1,sortBy:!1,queryStr:""},view:{filterModal:{visible:!1,stagingFilter:{}},filterOptions:{periods:[],regions:[]}}},actions:i}),R=Object(l.c)(),E=Object(l.b)(),P=r(1),L=function(e){var t=E(),r=R(),i=r.view.filterModal,n=r.view.filterOptions,a=i.stagingFilter,o=function(){return t.toggleFilterModal()};return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)(d.a,{className:"my-3",size:"lg",children:[Object(P.jsx)(g.a,{onChange:e.onChange,"aria-label":"Large","aria-describedby":"inputGroup-sizing-sm",placeholder:"Search"}),Object(P.jsx)(c.a,{variant:"primary",onClick:function(){return t.toggleFilterModal()},children:"Filter menu"}),Object(P.jsxs)(p.a,{size:"lg",show:i.visible,onHide:o,children:[Object(P.jsx)(p.a.Header,{closeButton:!0,children:Object(P.jsx)(p.a.Title,{children:"Advance Filtering Menu"})}),Object(P.jsx)(p.a.Body,{className:"p-sm-5",children:Object(P.jsxs)(b.a,{children:[Object(P.jsx)("h5",{children:"Search by:"}),Object(P.jsx)(j.a,{className:"my-2",controlId:"floatingSelect",label:"By Period",children:Object(P.jsxs)(b.a.Select,{onChange:function(e){return t.mergeStagingFilter({period:e.target.value})},"aria-label":"Floating label select example",children:[Object(P.jsx)("option",{value:"",selected:!a.period,children:"All"}),n.periods.map((function(e,t){return Object(P.jsx)("option",{value:e,selected:e===a.period,children:e},t)}))]})}),Object(P.jsx)(j.a,{className:"my-2",controlId:"floatingSelect",label:"By Region",children:Object(P.jsxs)(b.a.Select,{onChange:function(e){return t.mergeStagingFilter({region:e.target.value})},"aria-label":"Floating label select example",children:[Object(P.jsx)("option",{value:"",selected:!a.region,children:"All"}),n.regions.map((function(e,t){return Object(P.jsx)("option",{value:e,selected:e===a.region,children:e},t)}))]})}),Object(P.jsxs)(b.a.Group,{as:u.a,className:"mb-3",children:[Object(P.jsx)(b.a.Label,{column:!0,sm:"2",children:"By Age:"}),Object(P.jsx)(h.a,{sm:"4",children:Object(P.jsx)(b.a.Control,{type:"number",placeholder:"Lower Bound",onChange:function(e){t.mergeStagingFilter({bottomAge:e.target.value})},value:a.bottomAge})}),Object(P.jsx)(h.a,{className:"d-flex justify-content-center",sm:"2",children:Object(P.jsx)("p",{className:"m-auto",children:"to"})}),Object(P.jsx)(h.a,{sm:"4",children:Object(P.jsx)(b.a.Control,{type:"number",placeholder:"Upper Bound",onChange:function(e){t.mergeStagingFilter({topAge:e.target.value})},value:a.topAge})})]}),Object(P.jsx)("hr",{}),Object(P.jsx)("h5",{children:"Sort by:"}),Object(P.jsxs)(b.a.Group,{className:"mb-3",onChange:function(e){t.mergeStagingFilter({sortBy:e.target.value})},children:[Object(P.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-alphabetically",value:"alphabet",checked:"alphabet"===a.sortBy}),Object(P.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-by-age",value:"age",checked:"age"===a.sortBy}),Object(P.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-by-region (coming soon)",value:"region",checked:"region"===a.sortBy})]}),Object(P.jsx)("hr",{}),Object(P.jsx)("h5",{children:"Group by:"})]})}),Object(P.jsxs)(p.a.Footer,{children:[Object(P.jsx)(c.a,{variant:"secondary",onClick:o,children:"Close"}),Object(P.jsx)(c.a,{variant:"danger",onClick:t.resetFilters,children:"Reset"}),Object(P.jsx)(c.a,{variant:"primary",onClick:function(){return t.applyFilters()},children:"Apply"})]})]})]}),Object(P.jsx)("p",{})]})};window.processGithubResponse||(window.processGithubResponse=function(e){console.log("Callback was called w/ data: ",e)});var U=function(){var e=R(),t=E(),r=e.isLoading,i=e.masterdata,n=!1;return e.selectedItem&&(function(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!=t.status}(n="/geowhen/stage-charts/".concat(e.selectedItem.Period.toUpperCase(),"_regional.jpg"))||(n=!1)),Object(P.jsx)("div",{className:"mx-auto mt-4",style:{width:"90%"},children:r?Object(P.jsx)("p",{children:"Loading..."}):Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(L,{onChange:function(e){t.mergeFilter({queryStr:e.target.value})}}),Object(P.jsx)("div",{className:"mt-5 border shadow-sm",style:{height:"400px",overflowX:"scroll"},children:Object(P.jsx)("div",{className:"scrolling-wrapper row flex-row flex-nowrap mt-4 pb-4 pt-2",children:Object.keys(i.displayedStages).map((function(e,r){return i.displayedStages[e]&&i.displayedStages[e].length<1?"":Object(P.jsxs)("div",{className:"col",align:"center",style:{border:"1px solid #DDDDDD",borderRadius:"3px",boxShadow:"3px 3px #CCCCC",margin:"5px 5px 5px 5px"},children:[Object(P.jsx)("strong",{children:e}),i.displayedStages[e].map((function(e,r){return Object(P.jsx)("div",{className:"my-2 col-8 d-flex justify-content-center",children:Object(P.jsx)(c.a,{onClick:function(){t.selectItem(e)},children:e.STAGE})},r)}))]},r)}))})}),e.selectedItem?Object(P.jsxs)("div",{className:"mt-5 border shadow-sm",children:[Object(P.jsxs)("div",{children:[e.selectedItem.STAGE," (Period: ",e.selectedItem.Period,")"]}),Object(P.jsxs)("div",{children:["Region: ",e.selectedItem.Region]}),Object(P.jsxs)("div",{children:["Top Age: ",+e.selectedItem.TOP.toFixed(3)]}),Object(P.jsxs)("div",{children:["Base Age: ",+e.selectedItem.Base.toFixed(3)]}),Object(P.jsxs)("div",{children:["Top Calibration: ",e.selectedItem["Top calibration"]]}),Object(P.jsxs)("div",{children:["Base Calibration: ",e.selectedItem["Base calibration"]]}),n?Object(P.jsx)("img",{src:n}):""]}):""]})})};s.a.render(Object(P.jsx)(l.a,{value:N,children:Object(P.jsx)(a.a.StrictMode,{children:Object(P.jsx)(U,{})})}),document.getElementById("root"))},52:function(e,t){},73:function(e,t,r){},97:function(e,t){},98:function(e,t){}},[[102,1,2]]]);
//# sourceMappingURL=main.7c5d933b.chunk.js.map