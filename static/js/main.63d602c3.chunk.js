(this.webpackJsonpgeowhen=this.webpackJsonpgeowhen||[]).push([[0],{102:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"onInitializeOvermind",(function(){return F})),r.d(n,"doFilter",(function(){return A})),r.d(n,"mergeFilter",(function(){return N})),r.d(n,"applyFilters",(function(){return k})),r.d(n,"toggleFilterModal",(function(){return B}));var i=r(0),a=r.n(i),o=r(20),s=r.n(o),l=r(31),c=(r(73),r(74),r(25)),d=r(108),j=r(57),u=r(106),b=r(107),g=r(63),p=r(105),h=r(62),f=r(21),m=r(2),O=r(28),y=r.n(O),x=r(55),v=r(56),w=r.n(v),S=r(42),C=r.n(S),F=function(){var e=Object(x.a)(y.a.mark((function e(t){var r,n,i,a,o,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.state).isLoading=!0,e.next=4,w.a.get("https://api.github.com/repos/earthhistoryviz/geowhen/contents/data/MasterData.xlsx",{headers:{Accept:"application/vnd.github.v3.raw"},responseType:"arraybuffer"});case 4:n=e.sent,i=C.a.read(new Uint8Array(n.data),{type:"array"}),a=C.a.utils.sheet_to_json(i.Sheets["Geological stages"]).slice(1),console.log(a),o=a.reduce((function(e,t){return e[t.Period]||(e[t.Period]=[]),e[t.Period].push(t),e}),{}),s=a.reduce((function(e,t){return e.periods.add(t.Period),t.Region&&" "!==t.Region&&e.regions.add(t.Region),e}),{periods:new Set,regions:new Set}),console.log("byperiod = ",o),r.masterdata.byperiod=o,r.masterdata.displayedStages=o,r.view.filterOptions.periods=Array.from(s.periods),r.view.filterOptions.regions=Array.from(s.regions),r.isLoading=!1;case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(e){var t=e.state,r={},n=t.filter;Object.keys(t.masterdata.byperiod).forEach((function(e){var i=t.masterdata.byperiod[e];r[e]=i.filter((function(e){return e.STAGE.toUpperCase().includes(n.queryStr.toUpperCase())?(console.log("region type is: ",typeof e.Region),!(n.region&&("string"!==typeof e.Region||!e.Region.toUpperCase().includes(n.region.toUpperCase())))||(console.log("filter region denies inclusion of "+e.STAGE),!1)):(console.log("query string denies inclusion of "+e.STAGE),!1)}))})),t.masterdata.displayedStages=r},N=function(e,t){var r=e.state,n=e.actions;r.filter=Object(m.a)(Object(m.a)({},r.filter),t),n.doFilter(),console.log(r)},k=function(e){var t=e.state;t.view.filterModal.visible=!t.view.filterModal.visible,alert("Im going to filter using: \n"+JSON.stringify(t.filter))},B=function(e){var t=e.state;t.view.filterModal.visible=!t.view.filterModal.visible},M=Object(f.d)({state:{isLoading:!0,masterdata:{byperiod:{},displayedStages:{},raw:[]},filter:{period:!1,region:!1,topAge:!1,bottomAge:!1,sortBy:!1,queryStr:""},view:{filterModal:{visible:!1},filterOptions:{periods:[],regions:[]}}},actions:n}),G=Object(l.c)(),R=Object(l.b)(),L=r(1),E=function(e){var t=R(),r=G(),n=r.view.filterModal,i=r.view.filterOptions,a=r.filter,o=function(){return t.toggleFilterModal()};return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(d.a,{className:"my-3",size:"lg",children:[Object(L.jsx)(j.a,{onChange:e.onChange,"aria-label":"Large","aria-describedby":"inputGroup-sizing-sm",placeholder:"Search"}),Object(L.jsx)(c.a,{variant:"primary",onClick:function(){return t.toggleFilterModal()},children:"Filter menu"}),Object(L.jsxs)(u.a,{size:"lg",show:n.visible,onHide:o,children:[Object(L.jsx)(u.a.Header,{closeButton:!0,children:Object(L.jsx)(u.a.Title,{children:"Advance Filtering Menu"})}),Object(L.jsx)(u.a.Body,{className:"p-sm-5",children:Object(L.jsxs)(b.a,{children:[Object(L.jsx)("h5",{children:"Search by:"}),Object(L.jsx)(g.a,{className:"my-2",controlId:"floatingSelect",label:"By Period",children:Object(L.jsxs)(b.a.Select,{onChange:function(e){return t.mergeFilter({period:e.target.value})},"aria-label":"Floating label select example",children:[Object(L.jsx)("option",{value:"",selected:!a.period,children:"All"}),i.periods.map((function(e,t){return Object(L.jsx)("option",{value:e,selected:e===a.period,children:e},t)}))]})}),Object(L.jsx)(g.a,{className:"my-2",controlId:"floatingSelect",label:"By Region",children:Object(L.jsxs)(b.a.Select,{onChange:function(e){return t.mergeFilter({region:e.target.value})},"aria-label":"Floating label select example",children:[Object(L.jsx)("option",{value:"",selected:!a.region,children:"All"}),i.regions.map((function(e,t){return Object(L.jsx)("option",{value:e,selected:e===a.region,children:e},t)}))]})}),Object(L.jsxs)(b.a.Group,{as:p.a,className:"mb-3",children:[Object(L.jsx)(b.a.Label,{column:!0,sm:"2",children:"By Age:"}),Object(L.jsx)(h.a,{sm:"4",children:Object(L.jsx)(b.a.Control,{type:"number",placeholder:"Lower Bound",onChange:function(e){t.mergeFilter({bottomAge:e.target.value})}})}),Object(L.jsx)(h.a,{className:"d-flex justify-content-center",sm:"2",children:Object(L.jsx)("p",{className:"m-auto",children:"to"})}),Object(L.jsx)(h.a,{sm:"4",children:Object(L.jsx)(b.a.Control,{type:"number",placeholder:"Upper Bound",onChange:function(e){t.mergeFilter({topAge:e.target.value})}})})]}),Object(L.jsx)("hr",{}),Object(L.jsx)("h5",{children:"Sort by:"}),Object(L.jsxs)(b.a.Group,{className:"mb-3",onChange:function(e){t.mergeFilter({sortBy:e.target.value})},children:[Object(L.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-alphabetically",value:"alphabet"}),Object(L.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-by-age",value:"age"}),Object(L.jsx)(b.a.Check,{type:"radio",name:"sortBy",label:"sort-by-region",value:"region"})]}),Object(L.jsx)("hr",{}),Object(L.jsx)("h5",{children:"Group by:"})]})}),Object(L.jsxs)(u.a.Footer,{children:[Object(L.jsx)(c.a,{variant:"secondary",onClick:o,children:"Close"}),Object(L.jsx)(c.a,{variant:"danger",onClick:o,children:"Reset"}),Object(L.jsx)(c.a,{variant:"primary",onClick:function(){return t.applyFilters()},children:"Apply"})]})]})]}),Object(L.jsx)("p",{})]})};window.processGithubResponse||(window.processGithubResponse=function(e){console.log("Callback was called w/ data: ",e)});var T=function(){var e=G(),t=R(),r=e.isLoading,n=e.masterdata;return Object(L.jsx)("div",{className:"mx-auto mt-4",style:{width:"90%"},children:r?Object(L.jsx)("p",{children:"Loading..."}):Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(E,{onChange:function(e){t.mergeFilter({queryStr:e.target.value})}}),Object(L.jsx)("div",{className:"mt-3 border shadow-sm",style:{height:"400px",overflowX:"scroll"},children:Object(L.jsx)("div",{className:"mx-auto row px-2 w-100",children:Object.keys(n.displayedStages).map((function(e,t){return Object(L.jsxs)("div",{className:"row",children:[Object(L.jsx)("strong",{children:e}),n.displayedStages[e].map((function(e,t){return Object(L.jsx)("div",{className:"my-2 col-2 d-flex justify-content-center",children:Object(L.jsx)(c.a,{children:e.STAGE})},t)}))]},t)}))})})]})})};s.a.render(Object(L.jsx)(l.a,{value:M,children:Object(L.jsx)(a.a.StrictMode,{children:Object(L.jsx)(T,{})})}),document.getElementById("root"))},52:function(e,t){},73:function(e,t,r){},97:function(e,t){},98:function(e,t){}},[[102,1,2]]]);
//# sourceMappingURL=main.63d602c3.chunk.js.map